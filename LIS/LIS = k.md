# LIS = k

## 题面

给定正整数k和序列a，长度为n，$a_i\leq k$，允许你删除任意元素任意次，使得做完所有操作后的序列的LIS<k，问最少要删除多少个元素

$k\leq n\leq 2*10^5$

## 做法

注意到由于$a_i\leq k$，那么$LIS\in[1,k]$，当LIS=k时，满足的子序列一定是$1、2、\dots、k$，考虑将这样的序列按出现顺序分组（即：是第几个$LIS_k$），显然对于每条链我们只需要删1种元素，当然被删的元素也是非下降的，不然前面组的会对后面的造成影响。这样的组显然至多只有$O(\frac{n}{k})$

考虑朴素dp：
$f[i][j]:表示第i个团删除j元素的最小代价$

那么转移就是：

$f[i][j] = min_{x=1}^j(f[i - 1][x])+cnt[j]$

这是个$O(\frac{n}{k}*k*k)$的转移，但显然可以用前缀min进行优化，则：

$f[i][j]=min[j]+cnt[j]$

这就变成$O(\frac{n}{k}*k)=O(n)$的了

对于空间的优化，我们不难发现，我们在意的其实只有当前组和上一组，其实也可以滚动优化（用双指针啥的乱搞）

