# 约数之和

## 题目

对于正整数n,记$\sigma_2$为其所有约数的平方和,即:$\sigma_2(n)=\sum_{d|n}d^2$

现在给你两个整数N和K,其中$1\leq n\leq N$,有些n满足$\sigma_2(n)$和其最接近的完全平方数相差不超过K,求所有满足条件的n的和

其中$1\leq q\leq 10^5,1\leq N\leq 10^6, 0\leq K\leq 10^5$

## 做法

预处理用埃筛将$[1,10^6]$的$\sigma_2$的值筛出来和平方数求出来，对于每个值都二分出他的最小K,记为$k_{min}$。显然对于所有$K\geq k_{min}$当前值都有贡献。

此时问题已经转换成,q次询问，每次N和K,问[1, N]里有多少个数$\leq K$。这个问题显然可以通过在线主席树或者离线线段树、离线树状数组解决。

离线线段树：对N离线，从小到大，对K开线段树维护答案，每次加n直到下一个N，然后通过线段树维护答案

## 更改

将完全平方数变成$\sum_{i=1}^n i^2$。将约数平方数之和$\sum_{d|n}d^2$变成$\sum_{i=1}^nd_2(i)$

