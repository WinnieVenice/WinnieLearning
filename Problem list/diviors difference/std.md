# 约数差

首先观察$|D_2(n)-\sum_{j=1}D_1(j)|_{min}\leq K$，不难知道，对于每个n都存在一个$K_{min}$，使得对任意$K\geq K_{min}$，n都是有贡献的。

考虑如何快速找到这个$K_{min}$，我们发现$\sum_{j=1}D_1(j)$是单调递增的，但是$D_2不一定是单调递增$，所以我们可以对每个$D_2$二分地在$\sum_{j=1}D_1(j)$中找到他的位置，那$K_{min}$只有可能是第一个$\geq或\leq D_2(n)$的前缀和$D_1$

考虑如何求$D_2和D_1$，$D_1(n)=\sum_{d|n}d=\sum_{d=1}^n[d|n]*d$，可以知道满足d|n的n对于某个d来说一定是d的倍数，到这里你就自然想到埃筛，由于N只有1e6所以可以使用埃筛先把$D_2$筛出来。为了保证每个$D_2$都能二分出他的$K_{min}$，我们需要使得$\max_{i=1}^{10^6}\{D_2(i)\}\leq max\{\sum_{j=1} D_1(j)\}$，随便测一下发现只需要预处理出$2*10^6$的$D_1$就远远满足上式

然后接下来就是二维偏序问题，经典离线trick，选择一维使其变得有序，然后就变成一维的问题了。

将询问按N从小到大排序，维护一个当前n，每次都计算n~N的贡献

另一方面对K进行维护，那实际上要维护的就是一个K的前缀和

那我们只需要选择一个能支持单点更新和前缀和查询的数据结构就能做了

## 数据加强

事实上可以将N拓展到1e7把埃筛卡掉，就得用线性筛处理D1、D2
$$
\\ n=\prod p_i^{e_i}， D_1(n)=\prod_i\sum_{j=0}^{e_i}p_i^{j},D_2(n)=\prod_i\sum_{j=0}^{e_i}(p_i^{j})^2
\\ 有很多种维护的方法
\\ 考虑辅助数组sp(n)表示除去最小质因数部分的贡献的下标
\\ 那么sp(n)=\begin{cases}1, n\in prime\\ sp(i), n=i*p_j,p_j|i\\ i,其他\end{cases}
\\ 那么D_2在线性筛上的转移也很显然:
\\ n=i*p_j,p_j|i时，D_2(n)=D_2(sp(i))+D_2(i)*p_j^2
\\ 其他，D_2(n)=D_2(i)*(p_j^2+1)
$$




